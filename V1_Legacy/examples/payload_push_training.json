{
    "task_name": "payload_push_swarm",
    "world_width": 100.0,
    "world_height": 100.0,
    "env_params": {
        "num_agents": 20,
        "dt": 0.1,
        "friction": 0.15,
        "payload_friction": 0.05,
        "goal_type": "static",
        "agent_mode": "nav",
        "enable_communication": true,
        "comm_range": 50.0,
        "packet_loss_prob": 0.05,
        "special_objects": [
            {
                "type": "payload",
                "x": 50,
                "y": 50,
                "radius": 8,
                "mass": 15.0
            },
            {
                "type": "goal",
                "x": 85,
                "y": 85,
                "radius": 12
            }
        ],
        "sensors": [
            "position",
            "velocity",
            "goal_vector",
            "neighbor_vectors",
            "obstacle_radar",
            "neighbor_signals",
            "energy"
        ],
        "reward_code": "# Payload Push Reward\n# Access payload and goal\npayload = env_state.get('payloads', [{}])[0] if env_state.get('payloads') else {'x': 50, 'y': 50}\ngoal = env_state['goals'][0]\n\n# 1. Payload -> Goal Distance (Main objective)\npayload_to_goal = math.sqrt((payload['x'] - goal['x'])**2 + (payload['y'] - goal['y'])**2)\nreward -= payload_to_goal / 20.0\n\n# 2. Agent -> Payload (Encourage getting close to push)\nagent_to_payload = math.sqrt((agent['x'] - payload['x'])**2 + (agent['y'] - payload['y'])**2)\nif agent_to_payload < 15: reward += 0.5\nif agent_to_payload < 8: reward += 1.0\n\n# 3. Payload at Goal Bonus\nif payload_to_goal < goal['radius']: reward += 50.0\n\n# 4. Alignment: Agent velocity towards payload\nif agent_to_payload > 0.1:\n    dx = payload['x'] - agent['x']\n    dy = payload['y'] - agent['y']\n    norm = math.sqrt(dx**2 + dy**2)\n    nx, ny = dx/norm, dy/norm\n    alignment = agent['vx']*nx + agent['vy']*ny\n    reward += alignment * 0.3\n\n# 5. Wall Penalty\nw, h = env_state.get('world_width', 100), env_state.get('world_height', 100)\nmargin = 5.0\nif agent['x'] < margin or agent['x'] > w - margin: reward -= 1.0\nif agent['y'] < margin or agent['y'] > h - margin: reward -= 1.0\n\n# 6. Communication Bonus (Encourage signaling near payload)\nif 'comm' in agent and abs(agent['comm']) > 0.1 and agent_to_payload < 20:\n    reward += 0.1"
    },
    "training_params": {
        "algo": "PPO",
        "total_timesteps": 500000,
        "learning_rate": 0.0003,
        "max_episode_steps": 500,
        "n_envs": 4,
        "normalize": true,
        "save_model_path": "models/saved/payload_push_swarm"
    }
}